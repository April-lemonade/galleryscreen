<template>
  <div class="image-map-container">
    <img src="../assets/map.jpg" alt="Map" @load="onImageLoad"
         style="display: flex; width: 1500px; height: auto;position: absolute;z-index: 1"/>
    <div v-for="(item,index) in hotArtworks" :key="index"
         style="z-index:3;position: absolute;width: 150px;background: transparent;"
         :style="{left: `${item.position.x * 1.5}px`, top: `${760 - item.position.y * 1.5}px`}">
      {{ item.id }}
      <!--      <div style="position: relative;display: flex;">-->
      <!--        <div style="width: 15px">test</div>-->
      <!--      </div>-->
      <!--      <img style="background: transparent;width: 100%" src="../assets/imgbg.jpg" alt=""/>-->
      <!--      <img style="background: transparent;width: 80%" src="../assets/imgdir.jpg" alt=""/>-->
    </div>
    <canvas ref="canvas" :style="{ position: 'relative', top: '0px', left: '0px',zIndex:'2' }"></canvas>

  </div>
</template>

<script>
export default {
  name: 'MapView',
  props: {
    path: String
  },
  data() {
    return {
      width: 1000,
      height: 500,
      pathPoints: [
        {x: 500, y: 390},
        {x: 510, y: 380},
        {x: 520, y: 370},
        {x: 515, y: 360},
        {x: 515, y: 350},
        {x: 522, y: 340},
        {x: 532, y: 331},
        {x: 542, y: 325},
        {x: 552, y: 321},
        {x: 562, y: 314},
        {x: 572, y: 316},
        {x: 582, y: 314},
        {x: 592, y: 310},
        {x: 602, y: 310},
        {x: 612, y: 311},
        {x: 622, y: 301},
        {x: 632, y: 291},
        {x: 642, y: 284},
        {x: 651, y: 274},
        {x: 661, y: 264},
        {x: 668, y: 254},
        {x: 674, y: 244},
        {x: 680, y: 234},
        {x: 690, y: 224},
        {x: 700, y: 226},
        {x: 699, y: 236},
        {x: 694, y: 246},
        {x: 684, y: 256},
        {x: 685, y: 255},
        {x: 695, y: 245},
        {x: 702, y: 235},
        {x: 703, y: 225},
        {x: 713, y: 215},
        {x: 723, y: 217},
        {x: 733, y: 212},
        {x: 743, y: 206},
        {x: 753, y: 214},
        {x: 763, y: 220},
        {x: 773, y: 222},
        {x: 781, y: 232},
        {x: 787, y: 242},
        {x: 793, y: 250},
        {x: 803, y: 250},
        {x: 798, y: 251},
        {x: 788, y: 252},
        {x: 778, y: 255},
        {x: 768, y: 253},
        {x: 758, y: 248},
        {x: 750, y: 249},
        {x: 750, y: 239},
        {x: 750, y: 229},
        {x: 750, y: 219},
        {x: 756, y: 209},
        {x: 761, y: 199},
        {x: 770, y: 190},
        {x: 780, y: 193},
        {x: 790, y: 194},
        {x: 800, y: 191},
        {x: 810, y: 190},
        {x: 809, y: 181},
        {x: 799, y: 171},
        {x: 792, y: 161},
        {x: 792, y: 157},
        {x: 782, y: 152},
        {x: 772, y: 152},
        {x: 762, y: 154},
        {x: 752, y: 156},
        {x: 742, y: 158},
        {x: 732, y: 160},
        {x: 722, y: 162},
        {x: 712, y: 162},
        {x: 702, y: 162},
        {x: 692, y: 166},
        {x: 682, y: 166},
        {x: 672, y: 166},
        {x: 662, y: 164},
        {x: 652, y: 152},
        {x: 642, y: 152},
        {x: 632, y: 152},
        {x: 624, y: 161},
        {x: 624, y: 171},
        {x: 624, y: 181},
        {x: 621, y: 191},
        {x: 618, y: 201},
        {x: 617, y: 211},
        {x: 617, y: 221},
        {x: 617, y: 231},
        {x: 620, y: 241},
        {x: 617, y: 251},
        {x: 617, y: 261},
        {x: 618, y: 271},
        {x: 617, y: 281},
        {x: 614, y: 291},
        {x: 604, y: 301},
        {x: 594, y: 310},
        {x: 584, y: 314},
        {x: 574, y: 316},
        {x: 564, y: 315},
        {x: 555, y: 309},
        {x: 545, y: 304},
        {x: 535, y: 300},
        {x: 525, y: 299},
        {x: 518, y: 290},
        {x: 513, y: 280},
        {x: 507, y: 270},
        {x: 502, y: 261},
        {x: 493, y: 255},
        {x: 498, y: 245},
        {x: 493, y: 235},
        {x: 483, y: 228},
        {x: 473, y: 228},
        {x: 468, y: 224},
        {x: 466, y: 214},
        {x: 465, y: 204},
        {x: 474, y: 200},
        {x: 477, y: 200},
        {x: 467, y: 201},
        {x: 457, y: 202},
        {x: 448, y: 208},
        {x: 446, y: 218},
        {x: 443, y: 228},
        {x: 440, y: 238},
        {x: 437, y: 248},
        {x: 428, y: 256},
        {x: 418, y: 257},
        {x: 408, y: 253},
        {x: 400, y: 243},
        {x: 395, y: 233},
        {x: 392, y: 223},
        {x: 391, y: 213},
        {x: 393, y: 216},
        {x: 395, y: 226},
        {x: 398, y: 236},
        {x: 403, y: 246},
        {x: 410, y: 256},
        {x: 417, y: 266},
        {x: 426, y: 276},
        {x: 434, y: 286},
        {x: 442, y: 296},
        {x: 452, y: 306},
        {x: 462, y: 307},
        {x: 472, y: 310},
        {x: 482, y: 312},
        {x: 492, y: 318},
        {x: 494, y: 328},
        {x: 490, y: 338},
        {x: 489, y: 348},
        {x: 489, y: 358},
        {x: 490, y: 368},
        {x: 490, y: 378},
        {x: 498, y: 388}
      ], // 路径点
      pathPoints1: [{x: 500, y: 390},
        {x: 500, y: 385},
        {x: 502, y: 380},
        {x: 499, y: 375},
        {x: 494, y: 370},
        {x: 490, y: 365},
        {x: 486, y: 360},
        {x: 488, y: 355},
        {x: 484, y: 350},
        {x: 483, y: 345},
        {x: 485, y: 340},
        {x: 488, y: 335},
        {x: 493, y: 330},
        {x: 495, y: 325},
        {x: 496, y: 320},
        {x: 491, y: 315},
        {x: 486, y: 311},
        {x: 481, y: 306},
        {x: 476, y: 301},
        {x: 471, y: 301},
        {x: 466, y: 301},
        {x: 461, y: 302},
        {x: 456, y: 302},
        {x: 451, y: 302},
        {x: 446, y: 300},
        {x: 442, y: 295},
        {x: 438, y: 290},
        {x: 435, y: 285},
        {x: 432, y: 280},
        {x: 429, y: 275},
        {x: 424, y: 270},
        {x: 419, y: 265},
        {x: 414, y: 260},
        {x: 409, y: 255},
        {x: 404, y: 250},
        {x: 400, y: 245},
        {x: 402, y: 240},
        {x: 398, y: 235},
        {x: 398, y: 230},
        {x: 399, y: 225},
        {x: 396, y: 220},
        {x: 392, y: 215},
        {x: 390, y: 210},
        {x: 393, y: 206},
        {x: 396, y: 201},
        {x: 401, y: 196},
        {x: 406, y: 191},
        {x: 410, y: 186},
        {x: 414, y: 181},
        {x: 416, y: 180},
        {x: 411, y: 184},
        {x: 410, y: 189},
        {x: 414, y: 194},
        {x: 419, y: 199},
        {x: 424, y: 204},
        {x: 424, y: 209},
        {x: 423, y: 214},
        {x: 419, y: 219},
        {x: 416, y: 224},
        {x: 418, y: 229},
        {x: 418, y: 234},
        {x: 415, y: 239},
        {x: 410, y: 244},
        {x: 408, y: 249},
        {x: 409, y: 254},
        {x: 414, y: 257},
        {x: 419, y: 257},
        {x: 424, y: 256},
        {x: 429, y: 256},
        {x: 434, y: 252},
        {x: 437, y: 247},
        {x: 439, y: 242},
        {x: 440, y: 237},
        {x: 441, y: 232},
        {x: 446, y: 227},
        {x: 446, y: 222},
        {x: 446, y: 217},
        {x: 445, y: 212},
        {x: 449, y: 207},
        {x: 453, y: 202},
        {x: 458, y: 203},
        {x: 463, y: 202},
        {x: 468, y: 201},
        {x: 473, y: 200},
        {x: 478, y: 200},
        {x: 478, y: 200},
        {x: 473, y: 200},
        {x: 468, y: 201},
        {x: 465, y: 205},
        {x: 466, y: 210},
        {x: 463, y: 215},
        {x: 464, y: 220},
        {x: 469, y: 225},
        {x: 470, y: 230},
        {x: 469, y: 226},
        {x: 464, y: 221},
        {x: 468, y: 216},
        {x: 473, y: 211},
        {x: 478, y: 213},
        {x: 478, y: 213},
        {x: 473, y: 214},
        {x: 468, y: 216},
        {x: 464, y: 221},
        {x: 463, y: 226},
        {x: 463, y: 231},
        {x: 464, y: 236},
        {x: 463, y: 241},
        {x: 463, y: 246},
        {x: 464, y: 251},
        {x: 464, y: 256},
        {x: 466, y: 261},
        {x: 470, y: 265},
        {x: 471, y: 270},
        {x: 471, y: 275},
        {x: 468, y: 280},
        {x: 467, y: 285},
        {x: 466, y: 290},
        {x: 470, y: 295},
        {x: 475, y: 300},
        {x: 480, y: 305},
        {x: 485, y: 310},
        {x: 490, y: 314},
        {x: 494, y: 319},
        {x: 494, y: 324},
        {x: 494, y: 329},
        {x: 493, y: 334},
        {x: 497, y: 339},
        {x: 502, y: 344},
        {x: 503, y: 349},
        {x: 503, y: 354},
        {x: 500, y: 359},
        {x: 502, y: 364},
        {x: 502, y: 369},
        {x: 502, y: 374},
        {x: 499, y: 379},
        {x: 502, y: 384},
        {x: 499, y: 389}],
      pathPoints2: [{x: 500, y: 390},
        {x: 495, y: 385},
        {x: 490, y: 380},
        {x: 485, y: 375},
        {x: 480, y: 370},
        {x: 475, y: 365},
        {x: 477, y: 360},
        {x: 477, y: 355},
        {x: 477, y: 350},
        {x: 473, y: 345},
        {x: 468, y: 341},
        {x: 463, y: 336},
        {x: 458, y: 332},
        {x: 453, y: 329},
        {x: 448, y: 326},
        {x: 443, y: 323},
        {x: 438, y: 325},
        {x: 433, y: 325},
        {x: 428, y: 320},
        {x: 423, y: 318},
        {x: 418, y: 314},
        {x: 413, y: 310},
        {x: 410, y: 305},
        {x: 409, y: 300},
        {x: 407, y: 295},
        {x: 405, y: 290},
        {x: 404, y: 285},
        {x: 402, y: 280},
        {x: 398, y: 275},
        {x: 394, y: 270},
        {x: 389, y: 268},
        {x: 384, y: 267},
        {x: 379, y: 266},
        {x: 374, y: 266},
        {x: 369, y: 268},
        {x: 364, y: 270},
        {x: 359, y: 272},
        {x: 354, y: 273},
        {x: 349, y: 274},
        {x: 344, y: 276},
        {x: 339, y: 274},
        {x: 334, y: 273},
        {x: 329, y: 272},
        {x: 324, y: 267},
        {x: 319, y: 266},
        {x: 314, y: 270},
        {x: 309, y: 271},
        {x: 304, y: 273},
        {x: 299, y: 272},
        {x: 294, y: 274},
        {x: 289, y: 275},
        {x: 285, y: 279},
        {x: 280, y: 284},
        {x: 275, y: 285},
        {x: 270, y: 287},
        {x: 265, y: 286},
        {x: 260, y: 284},
        {x: 255, y: 281},
        {x: 250, y: 279},
        {x: 245, y: 276},
        {x: 240, y: 277},
        {x: 235, y: 275},
        {x: 230, y: 273},
        {x: 225, y: 271},
        {x: 220, y: 273},
        {x: 215, y: 271},
        {x: 210, y: 268},
        {x: 205, y: 269},
        {x: 200, y: 269},
        {x: 195, y: 271},
        {x: 190, y: 274},
        {x: 186, y: 279},
        {x: 182, y: 284},
        {x: 184, y: 289},
        {x: 185, y: 287},
        {x: 188, y: 282},
        {x: 189, y: 277},
        {x: 192, y: 272},
        {x: 197, y: 268},
        {x: 202, y: 267},
        {x: 207, y: 263},
        {x: 210, y: 260},
        {x: 214, y: 263},
        {x: 219, y: 266},
        {x: 224, y: 266},
        {x: 229, y: 266},
        {x: 234, y: 266},
        {x: 239, y: 266},
        {x: 244, y: 266},
        {x: 249, y: 267},
        {x: 254, y: 269},
        {x: 259, y: 273},
        {x: 264, y: 274},
        {x: 262, y: 273},
        {x: 257, y: 272},
        {x: 252, y: 268},
        {x: 247, y: 266},
        {x: 242, y: 265},
        {x: 237, y: 265},
        {x: 232, y: 265},
        {x: 227, y: 265},
        {x: 222, y: 265},
        {x: 217, y: 263},
        {x: 212, y: 259},
        {x: 208, y: 254},
        {x: 213, y: 249},
        {x: 218, y: 244},
        {x: 220, y: 239},
        {x: 221, y: 234},
        {x: 222, y: 229},
        {x: 220, y: 224},
        {x: 222, y: 220},
        {x: 227, y: 218},
        {x: 232, y: 218},
        {x: 237, y: 215},
        {x: 242, y: 210},
        {x: 247, y: 205},
        {x: 251, y: 200},
        {x: 254, y: 195},
        {x: 258, y: 190},
        {x: 263, y: 185},
        {x: 268, y: 182},
        {x: 273, y: 180},
        {x: 278, y: 175},
        {x: 283, y: 170},
        {x: 288, y: 166},
        {x: 293, y: 165},
        {x: 298, y: 163},
        {x: 303, y: 158},
        {x: 308, y: 160},
        {x: 313, y: 158},
        {x: 318, y: 154},
        {x: 323, y: 158},
        {x: 327, y: 160},
        {x: 332, y: 165},
        {x: 337, y: 170},
        {x: 342, y: 175},
        {x: 347, y: 180},
        {x: 352, y: 183},
        {x: 357, y: 186},
        {x: 362, y: 189},
        {x: 367, y: 194},
        {x: 372, y: 198},
        {x: 375, y: 203},
        {x: 380, y: 208},
        {x: 385, y: 211},
        {x: 390, y: 210},
        {x: 393, y: 206},
        {x: 396, y: 201},
        {x: 401, y: 196},
        {x: 406, y: 191},
        {x: 410, y: 186},
        {x: 414, y: 181},
        {x: 416, y: 180},
        {x: 411, y: 184},
        {x: 410, y: 189},
        {x: 414, y: 194},
        {x: 419, y: 199},
        {x: 424, y: 204},
        {x: 424, y: 209},
        {x: 423, y: 214},
        {x: 419, y: 219},
        {x: 416, y: 224},
        {x: 418, y: 229},
        {x: 418, y: 234},
        {x: 415, y: 239},
        {x: 410, y: 244},
        {x: 408, y: 249},
        {x: 409, y: 254},
        {x: 414, y: 257},
        {x: 419, y: 257},
        {x: 424, y: 256},
        {x: 429, y: 256},
        {x: 434, y: 252},
        {x: 437, y: 247},
        {x: 439, y: 242},
        {x: 440, y: 237},
        {x: 441, y: 232},
        {x: 446, y: 227},
        {x: 446, y: 222},
        {x: 446, y: 217},
        {x: 445, y: 212},
        {x: 449, y: 207},
        {x: 453, y: 202},
        {x: 458, y: 203},
        {x: 463, y: 203},
        {x: 467, y: 206},
        {x: 472, y: 207},
        {x: 477, y: 212},
        {x: 481, y: 214},
        {x: 486, y: 215},
        {x: 491, y: 217},
        {x: 493, y: 222},
        {x: 494, y: 227},
        {x: 499, y: 231},
        {x: 499, y: 236},
        {x: 500, y: 241},
        {x: 498, y: 245},
        {x: 494, y: 250},
        {x: 493, y: 255},
        {x: 489, y: 259},
        {x: 484, y: 264},
        {x: 481, y: 269},
        {x: 476, y: 274},
        {x: 471, y: 279},
        {x: 468, y: 284},
        {x: 466, y: 289},
        {x: 469, y: 294},
        {x: 474, y: 299},
        {x: 479, y: 304},
        {x: 484, y: 309},
        {x: 489, y: 314},
        {x: 494, y: 318},
        {x: 494, y: 323},
        {x: 494, y: 328},
        {x: 499, y: 333},
        {x: 502, y: 338},
        {x: 504, y: 343},
        {x: 504, y: 348},
        {x: 506, y: 353},
        {x: 505, y: 358},
        {x: 505, y: 363},
        {x: 505, y: 368},
        {x: 503, y: 373},
        {x: 499, y: 378},
        {x: 494, y: 383},
        {x: 498, y: 388}],
      hotArtworks: [
        {id: '14', position: {x: 390, y: 210}, img: require('../assets/HotArtwork/test.jpg')},
        {id: '10', position: {x: 493, y: 255}, img: require('../assets/HotArtwork/test.jpg')},
        {id: '15', position: {x: 417, y: 180}, img: require('../assets/HotArtwork/test.jpg')},
        {id: '12', position: {x: 470, y: 230}, img: require('../assets/HotArtwork/test.jpg')},
        {id: '11', position: {x: 480, y: 215}, img: require('../assets/HotArtwork/test.jpg')}
      ]
    };
  },

  methods: {
    onImageLoad(event) {
      this.width = event.target.width;
      this.height = event.target.height;
      this.drawPath();
    },
    drawPath() {
      const canvas = this.$refs.canvas;
      const ctx = canvas.getContext('2d');
      canvas.width = this.width;
      canvas.height = this.height;

      // 清除画布
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // 移动坐标原点到左下角并设置横轴和纵轴的范围
      ctx.translate(0, canvas.height); // 将原点移到左下角
      ctx.scale(canvas.width / 1000, -canvas.height / 500); // 缩放坐标系

      ctx.beginPath();
      this.pathPoints.forEach((point, index) => {
        if (index === 0) {
          ctx.moveTo(point.x, point.y);
        } else {
          ctx.lineTo(point.x, point.y);
        }
      });
      ctx.strokeStyle = '#B98333';
      ctx.lineWidth = 2;
      ctx.stroke();

      ctx.beginPath();
      this.pathPoints1.forEach((point, index) => {
        if (index === 0) {
          ctx.moveTo(point.x, point.y);
        } else {
          ctx.lineTo(point.x, point.y);
        }
      });
      ctx.strokeStyle = '#828046';
      ctx.lineWidth = 2;
      ctx.stroke();

      ctx.beginPath();
      this.pathPoints2.forEach((point, index) => {
        if (index === 0) {
          ctx.moveTo(point.x, point.y);
        } else {
          ctx.lineTo(point.x, point.y);
        }
      });
      ctx.strokeStyle = '#4F7C48';
      ctx.lineWidth = 2;
      ctx.stroke();
    }
  }
}
</script>

<style>
.image-map-container {
  position: relative;
  width: 100%;
  height: auto;
  //z-index: 1;
}

canvas {
  background-color: transparent;
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}
</style>